<!DOCTYPE html>
<html lang="de">

<head>
  <meta charset="UTF-8">
  <title>QuantOS</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="css/market.css">
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>

  <nav id="sidebar">
    <div id="logo">
      <span class="logo-icon">â—ˆ</span>
      <span class="logo-text">QuantOS</span>
    </div>
    <ul id="nav-links">
      <li class="nav-item active" data-page="home">
        <span class="nav-icon">ğŸ </span><span class="nav-label">Home</span>
      </li>
      <li class="nav-item" data-page="backtest">
        <span class="nav-icon">ğŸ“Š</span><span class="nav-label">Backtest</span>
      </li>
      <li class="nav-item" data-page="market">
        <span class="nav-icon">ğŸŒ¡ï¸</span><span class="nav-label">Market</span>
      </li>
      <li class="nav-item" data-page="markov">
        <span class="nav-icon">ğŸ”—</span><span class="nav-label">Markov</span>
      </li>
      <li class="nav-item" data-page="optimizer">
        <span class="nav-icon">âš™ï¸</span><span class="nav-label">Optimizer</span>
      </li>
      <li class="nav-item" data-page="synchro">
        <span class="nav-icon">ğŸ”</span><span class="nav-label">Data & Synchro</span>
      </li>
    </ul>
  </nav>

  <main id="main-content">

    <div id="page-home" class="page active">
      <div id="home-container">
        <h1>ğŸ“ˆ QuantOS</h1>
        <p class="subtitle">Deine persÃ¶nliche Quant-Trading-Plattform</p>
        <div id="module-cards"></div>
      </div>
    </div>

    <div id="page-backtest" class="page">

      <div id="perf-panel">
        <div class="panel-header">âš¡ Performance</div>
        <div id="perf-metrics">
          <p class="placeholder">Backtest starten um Ergebnisse zu sehen</p>
        </div>
      </div>

      <div id="backtest-body">

        <div id="panels-container">

          <div id="chart-panel">
            <div class="panel-header">ğŸ“ˆ Chart</div>
            <div class="panel-content">
              <div id="lwc-chart"></div>
              <div class="plot-legend" id="legend-chart"></div>
            </div>
          </div>

          <div id="equity-panel">
            <div class="panel-header">ğŸ“Š Equity Curve</div>
            <div class="panel-content">
              <div id="plotly-equity"></div>
              <div class="plot-legend" id="legend-equity"></div>
            </div>
          </div>

        </div>

        <div id="controls-panel">
          <div class="ctrl-section">
            <div class="ctrl-section-label">DATEN</div>
            <div class="ctrl-row">
              <label>Symbol</label>
              <div class="ctrl-row-inline">
                <input type="text" id="ctrl-symbol" value="SPY">
                <button id="btn-browse-symbols" title="Browse Symbols">ğŸ”</button>
              </div>
            </div>
            <div class="ctrl-row">
              <label>Timeframe</label>
              <select id="ctrl-interval">
                <option value="1d">1 Tag</option>
                <option value="1h">1 Stunde</option>
                <option value="30m">30 Min</option>
                <option value="15m">15 Min</option>
                <option value="5m">5 Min</option>
              </select>
            </div>
            <div class="ctrl-row">
              <label>Von</label>
              <input type="date" id="ctrl-start" value="2024-01-01">
            </div>
            <div class="ctrl-row">
              <label>Bis</label>
              <input type="date" id="ctrl-end" value="2025-01-01">
            </div>
            <div class="ctrl-row">
              <label>Kapital â‚¬</label>
              <input type="number" id="ctrl-capital" value="10000">
            </div>
          </div>

          <div class="ctrl-divider"></div>

          <div class="ctrl-section">
            <div class="ctrl-section-label">STRATEGIE</div>
            <div class="ctrl-row">
              <label>Strategie</label>
              <select id="ctrl-strategy"></select>
            </div>
            <div class="ctrl-row">
              <label>Fast SMA</label>
              <input type="number" id="ctrl-sma" value="20">
            </div>
          </div>

          <div class="ctrl-divider"></div>

          <div class="ctrl-section">
            <div class="ctrl-section-label">INDIKATOREN</div>
            <div class="ctrl-row-inline">
              <select id="ctrl-indicator"></select>
              <button id="btn-add-indicator">â•</button>
            </div>
            <div id="active-indicators"></div>
          </div>

          <div style="flex:1"></div>
          <button id="btn-run">â–¶ Backtest starten</button>
        </div>

      </div>
    </div>

    <!-- MARKET PAGE -->
    <div id="page-market" class="page">
      <div class="market-container">
        <div class="market-header">
          <span class="market-title">ğŸŒ¡ï¸ Market Heatmap</span>
          <div class="heatmap-tf-group">
            <button class="heatmap-tf-btn active" data-tf="1D">D</button>
            <button class="heatmap-tf-btn" data-tf="1W">W</button>
            <button class="heatmap-tf-btn" data-tf="1M">M</button>
            <button class="heatmap-tf-btn" data-tf="1Y">Y</button>
          </div>
          <span class="heatmap-count" id="heatmap-count"></span>
          <span class="heatmap-delay-hint" id="heatmap-delay-hint">â± Delayed ~75 min</span>
          <button class="heatmap-refresh-btn" id="btn-refresh-heatmap">ğŸ”„ Refresh</button>
        </div>

        <div id="heatmap-grid">
          <div class="heatmap-placeholder">ğŸŒ¡ï¸ Market Tab Ã¶ffnen um Daten zu laden</div>
        </div>
      </div>
    </div>

    <div id="page-markov" class="page">
      <div class="coming-soon"><span>ğŸ”—</span>
        <h2>Markov</h2>
        <p>Coming soon</p>
      </div>
    </div>

    <div id="page-optimizer" class="page">
      <div class="coming-soon"><span>âš™ï¸</span>
        <h2>Optimizer</h2>
        <p>Coming soon</p>
      </div>
    </div>

    <div id="page-synchro" class="page">
      <div class="synchro-container">
        <h1>ğŸ” Data & Synchro</h1>
        <p class="subtitle">API-Konfiguration & Cache-Verwaltung</p>

        <div id="api-key-status" style="
      display:inline-block;
      font-size:12px;
      font-weight:600;
      padding:6px 12px;
      border-radius:6px;
      background:#1a1a2e;
      border:1px solid #2a2a3e;
      margin-bottom:20px;
    ">
          âš ï¸ <span style="color:#ef5350;">Keine API-Keys</span>
        </div>

        <div id="synchro-notification" class="synchro-notification"></div>

        <div class="synchro-section">
          <h2>ğŸ“¡ Alpaca API</h2>
          <p class="section-desc">Deine API-Keys werden lokal im Browser gespeichert.</p>

          <div class="synchro-field">
            <label>API Key</label>
            <input type="text" id="input-alpaca-key" placeholder="PKXXXXXXXXXX">
          </div>

          <div class="synchro-field">
            <label>API Secret</label>
            <input type="password" id="input-alpaca-secret" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
          </div>

          <button id="btn-save-api" class="synchro-btn primary">ğŸ’¾ API-Keys speichern</button>
        </div>

        <div class="synchro-divider"></div>

        <div class="synchro-section">
          <h2>ğŸ—‘ï¸ Cache verwalten</h2>
          <p class="section-desc">Setze gespeicherte Einstellungen zurÃ¼ck.</p>

          <div class="synchro-reset-grid">
            <div class="reset-card">
              <div class="reset-icon">ğŸ”„</div>
              <h3>Partial Reset</h3>
              <p>Setzt Layout & Parameter zurÃ¼ck.<br><strong>API-Keys bleiben erhalten.</strong></p>
              <button id="btn-reset-partial" class="synchro-btn secondary">Partial Reset</button>
            </div>

            <div class="reset-card danger">
              <div class="reset-icon">âš ï¸</div>
              <h3>Full Reset</h3>
              <p>LÃ¶scht <strong>alle</strong> Daten inkl. API-Keys.<br>Nicht rÃ¼ckgÃ¤ngig zu machen!</p>
              <button id="btn-reset-full" class="synchro-btn danger">Full Reset</button>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Symbol Browser Modal -->
    <div id="symbol-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>ğŸ“Š Symbol auswÃ¤hlen</h3>
          <span class="modal-close">&times;</span>
        </div>
        <div class="modal-body">
          <input type="text" id="symbol-search" placeholder="Suche Symbol oder Name...">
          <div id="symbol-list"></div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="../node_modules/split.js/dist/split.js"></script>
    <script src="https://unpkg.com/lightweight-charts@4.2.0/dist/lightweight-charts.standalone.production.js"></script>
    <script src="js/cache.js"></script>
    <script src="js/api.js"></script>
    <script src="js/symbols.js"></script>
    <script src="js/home.js"></script>
    <script src="js/backtest.js"></script>
    <script src="js/market.js"></script>
    <script src="js/synchro.js"></script>
    <script src="js/app.js"></script>

</body>

</html>